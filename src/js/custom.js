const db={};function getGET(){var o=document.location.href;if(o.indexOf("?")>0){for(var e=o.split("?")[1].split("&"),t={},n=0,s=e.length;n<s;n++){var a=e[n].split("=");t[a[0]]=unescape(decodeURI(a[1]))}return t}}var guiInvitado,valores=getGET();valores?(guiInvitado=valores.gui,console.log(guiInvitado)):document.write("No se ha recibido ningún parámetro"),db.collection("eventoPlantilla").where("gui","==",guiInvitado).get().then((o=>{o.forEach((o=>{console.log(o.id," => ",o.data());const e=o.data();if($("#nombreInvitados").html(e.nombre),$("#mensajeEspecialParrafo").html(e.mensajeEspecial),1==e.pases)var t=e.pases+" Pase ";else t=e.pases+" Pases ";$("#numPasesInv").html(t),$("#numPasesInv2").html(t);var n,s=new QRCode("qrcode");n="¡Bienvenido! \n"+e.nombre+" \n"+t+"\nElisa & Marcos",console.log(n),s.makeCode(n),1==e.status||2==e.status?document.getElementById("QrSection").style.display="none":document.getElementById("ConfirmSection").style.display="none",2==e.status&&(document.getElementById("ConfirmSection").style.display="none",document.getElementById("invValida").style.display="none"),0==e.mensajeNoNinos&&(document.getElementById("MsjNinos").style.display="none"),1==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option>'),2==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option>'),3==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option> <option value="3">3 Pases</option>'),4==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option> <option value="3">3 Pases</option> <option value="4">4 Pases</option>'),5==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option> <option value="3">3 Pases</option> <option value="4">4 Pases</option> <option value="5">5 Pases</option> '),6==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option> <option value="3">3 Pases</option> <option value="4">4 Pases</option> <option value="5">5 Pases</option> <option value="6">6 Pases</option>'),7==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option> <option value="3">3 Pases</option> <option value="4">4 Pases</option> <option value="5">5 Pases</option> <option value="6">6 Pases</option> <option value="7">7 Pases</option>'),8==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option> <option value="3">3 Pases</option> <option value="4">4 Pases</option> <option value="5">5 Pases</option> <option value="6">6 Pases</option> <option value="7">7 Pases</option>  <option value="8">8 Pases</option>'),9==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option> <option value="3">3 Pases</option> <option value="4">4 Pases</option> <option value="5">5 Pases</option> <option value="6">6 Pases</option> <option value="7">7 Pases</option>  <option value="8">8 Pases</option> <option value="9">9 Pases</option>'),10==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option> <option value="3">3 Pases</option> <option value="4">4 Pases</option> <option value="5">5 Pases</option> <option value="6">6 Pases</option> <option value="7">7 Pases</option>  <option value="8">8 Pases</option> <option value="9">9 Pases</option> <option value="10">10 Pases</option>'),11==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option> <option value="3">3 Pases</option> <option value="4">4 Pases</option> <option value="5">5 Pases</option> <option value="6">6 Pases</option> <option value="7">7 Pases</option>  <option value="8">8 Pases</option> <option value="9">9 Pases</option> <option value="10">10 Pases</option> <option value="11">11 Pases</option>'),12==e.pases&&(document.getElementById("select_passes").innerHTML+='<option value="1">1 Pase</option> <option value="2">2 Pases</option> <option value="3">3 Pases</option> <option value="4">4 Pases</option> <option value="5">5 Pases</option> <option value="6">6 Pases</option> <option value="7">7 Pases</option>  <option value="8">8 Pases</option> <option value="9">9 Pases</option> <option value="10">10 Pases</option> <option value="11">11 Pases</option> <option value="12">12 Pases</option>')}))})).catch((o=>{console.log("Error getting documents: ",o)}));var batch=db.batch();const confirmForm_passes=document.getElementById("confirm-form-passes");var msjEspecial;confirmForm_passes.addEventListener("submit",(async o=>{o.preventDefault();var e=confirmForm_passes.select_passes,t=parseInt(e.value);console.log(t),msjEspecial=confirmForm_passes.confirmMsj,await db.collection("eventoPlantilla").where("gui","==",guiInvitado).get().then((o=>{o.forEach((o=>{console.log(o.id," => ",o.data());o.data();var e=db.collection("eventoPlantilla").doc(o.id);batch.update(e,{pases:t,status:3,mensaje:msjEspecial.value}),batch.commit().then((()=>{mensaje_success()}))}))})).catch((o=>{console.log("Error getting documents: ",o)}))}));const formDecline=document.getElementById("formDecline");function mensaje_success(){return Swal.fire({title:"¡Genial!",text:"Ha confirmado su asistencia",icon:"success",confirmButtonText:'<span class="expandedClick" onclick="gotoQr()">OK</span>',timerProgressBar:!1,padding:"1rem",backdrop:!0,position:"center",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,showConfirmButton:!0,showCloseButton:!1}).then($((function(){}))),!1}function mensaje_success2(){return Swal.fire({title:"¡Gracias por confirmar!",text:"Lamentamos no poder verte este día, pero otra ocasión será",icon:"success",confirmButtonText:'<span class="expandedClick" onclick="gotoQr()">OK</span>',timerProgressBar:!1,padding:"1rem",backdrop:!0,position:"center",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,showConfirmButton:!0,showCloseButton:!1}).then($((function(){}))),!1}function gotoQr(){window.location.reload(),window.location.hash="sectionQr"}function mensaje_error(){return Swal.fire({title:"Ooops",text:"¡Creo te falto algún dato!",icon:"warning",confirmButtonText:"OK",timerProgressBar:!1,padding:"1rem",backdrop:!0,position:"center",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,showConfirmButton:!0,showCloseButton:!0}),!1}formDecline.addEventListener("submit",(async o=>{o.preventDefault(),msjEspecial=formDecline.declineMsj,await db.collection("eventoPlantilla").where("gui","==",guiInvitado).get().then((o=>{o.forEach((o=>{console.log(o.id," => ",o.data());o.data();var e=db.collection("eventoPlantilla").doc(o.id);batch.update(e,{pases:0,status:2,mensaje:msjEspecial.value}),console.log(o.id," => ",o.data()),batch.commit().then((()=>{mensaje_success2()}))}))})).catch((o=>{console.log("Error getting documents: ",o)}))}));